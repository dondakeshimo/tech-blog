{"pageProps":{"post":{"title":"機械学習の正則化についてまとめ","date":"2019-06-04","slug":"2019-06-04-deep_learning_5","author":{"name":"JJ Kasper","picture":"/assets/blog/authors/jj.jpeg"},"content":"<p>かなり回を重ねてきたけど，完全に自分のことしか見ていない.\n絶対他の人の役には立っていないとわかる．\nそんなブログで突き進む．\n前回同様，深層学習について学んだことをまとめる．\n今回のテーマは深層学習における正則化である．</p>\n<h1 id=\"目次\">目次</h1>\n<ul>\n<li><a href=\"#%E6%AD%A3%E5%89%87%E5%8C%96\">正則化</a></li>\n<li><a href=\"#%E3%83%91%E3%83%A9%E3%83%A1%E3%83%BC%E3%82%BF%E3%83%8E%E3%83%AB%E3%83%A0%E3%83%9A%E3%83%8A%E3%83%AB%E3%83%86%E3%82%A3\">パラメータノルムペナルティ</a>\n<ul>\n<li>\n<ul>\n<li><a href=\"#l2%E3%83%91%E3%83%A9%E3%83%A1%E3%83%BC%E3%82%BF%E6%AD%A3%E5%89%87%E5%8C%96\"><span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>L</mi><mn>2</mn></msup></mrow><annotation encoding=\"application/x-tex\">L^2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8141079999999999em;vertical-align:0em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">L</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141079999999999em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span></span></span></span></span>パラメータ正則化</a></li>\n<li><a href=\"#l1%E3%83%91%E3%83%A9%E3%83%A1%E3%83%BC%E3%82%BF%E6%AD%A3%E5%89%87%E5%8C%96\"><span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>L</mi><mn>1</mn></msup></mrow><annotation encoding=\"application/x-tex\">L^1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8141079999999999em;vertical-align:0em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">L</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141079999999999em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span></span></span></span></span></span></span></span></span>パラメータ正則化</a></li>\n</ul>\n</li>\n</ul>\n</li>\n<li><a href=\"#%E6%9D%A1%E4%BB%B6%E4%BB%98%E3%81%8D%E6%9C%80%E9%81%A9%E5%8C%96%E3%81%A8%E3%81%97%E3%81%A6%E3%81%AE%E3%83%8E%E3%83%AB%E3%83%A0%E3%83%9A%E3%83%8A%E3%83%AB%E3%83%86%E3%82%A3\">条件付き最適化としてのノルムペナルティ</a></li>\n<li><a href=\"#%E6%AD%A3%E5%89%87%E5%8C%96%E3%81%A8%E5%88%B6%E7%B4%84%E4%B8%8D%E8%B6%B3%E5%95%8F%E9%A1%8C\">正則化と制約不足問題</a></li>\n<li><a href=\"#%E3%83%87%E3%83%BC%E3%82%BF%E9%9B%86%E5%90%88%E3%81%AE%E6%8B%A1%E5%BC%B5\">データ集合の拡張</a></li>\n<li><a href=\"#%E3%83%8E%E3%82%A4%E3%82%BA%E3%81%AB%E5%AF%BE%E3%81%99%E3%82%8B%E9%A0%91%E5%81%A5%E6%80%A7\">ノイズに対する頑健性</a>\n<ul>\n<li>\n<ul>\n<li><a href=\"#%E5%87%BA%E5%8A%9B%E7%9B%AE%E6%A8%99%E3%81%B8%E3%81%AE%E3%83%8E%E3%82%A4%E3%82%BA%E3%81%AE%E6%B3%A8%E5%85%A5\">出力目標へのノイズの注入</a></li>\n</ul>\n</li>\n</ul>\n</li>\n<li><a href=\"#%E5%8D%8A%E6%95%99%E5%B8%AB%E3%81%82%E3%82%8A%E5%AD%A6%E7%BF%92\">半教師あり学習</a></li>\n<li><a href=\"#%E3%83%9E%E3%83%AB%E3%83%81%E3%82%BF%E3%82%B9%E3%82%AF%E5%AD%A6%E7%BF%92\">マルチタスク学習</a></li>\n<li><a href=\"#%E6%97%A9%E6%9C%9F%E7%B5%82%E4%BA%86\">早期終了</a></li>\n<li><a href=\"#%E3%83%91%E3%83%A9%E3%83%A1%E3%82%BF%E6%8B%98%E6%9D%9F%E3%81%A8%E3%83%91%E3%83%A9%E3%83%A1%E3%82%BF%E5%85%B1%E6%9C%89\">パラメタ拘束とパラメタ共有</a>\n<ul>\n<li>\n<ul>\n<li><a href=\"#%E7%95%B3%E3%81%BF%E8%BE%BC%E3%81%BF%E3%83%8B%E3%83%A5%E3%83%BC%E3%83%A9%E3%83%AB%E3%83%8D%E3%83%83%E3%83%88%E3%83%AF%E3%83%BC%E3%82%AF\">畳み込みニューラルネットワーク</a></li>\n</ul>\n</li>\n</ul>\n</li>\n<li><a href=\"#%E3%82%B9%E3%83%91%E3%83%BC%E3%82%B9%E8%A1%A8%E7%8F%BE\">スパース表現</a></li>\n<li><a href=\"#%E3%83%90%E3%82%AE%E3%83%B3%E3%82%B0%E3%82%84%E3%81%9D%E3%81%AE%E4%BB%96%E3%81%AE%E3%82%A2%E3%83%B3%E3%82%B5%E3%83%B3%E3%83%96%E3%83%AB%E6%89%8B%E6%B3%95\">バギングやその他のアンサンブル手法</a></li>\n<li><a href=\"#%E3%83%89%E3%83%AD%E3%83%83%E3%83%97%E3%82%A2%E3%82%A6%E3%83%88\">ドロップアウト</a></li>\n<li><a href=\"#%E6%95%B5%E5%AF%BE%E7%9A%84%E5%AD%A6%E7%BF%92\">敵対的学習</a></li>\n<li><a href=\"#%E6%8E%A5%E8%B7%9D%E9%9B%A2%EF%BC%8C%E6%8E%A5%E7%B7%9A%E4%BC%9D%E6%92%AD%E6%B3%95%EF%BC%8C%E5%A4%9A%E6%A7%98%E4%BD%93%E6%8E%A5%E5%88%86%E9%A1%9E%E5%99%A8\">接距離，接線伝播法，多様体接分類器</a></li>\n<li><a href=\"#%E3%81%BE%E3%81%A8%E3%82%81\">まとめ</a></li>\n</ul>\n<h1 id=\"正則化\">正則化</h1>\n<p>深層学習の観点では，正則化手法のほとんどは推定量の正則化に基づいている．\n推定量の正則化は，バイアスの増加とバリアンスの減少を引き換えることで機能する．\n過度にバイアスを増加させずにバリアンスを大きく減少させる正則化項が望まれる．</p>\n<h1 id=\"パラメータノルムペナルティ\">パラメータノルムペナルティ</h1>\n<div class=\"math math-display\"><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mover accent=\"true\"><mi>J</mi><mo>~</mo></mover><mo stretchy=\"false\">(</mo><mi mathvariant=\"bold\">θ</mi><mo separator=\"true\">;</mo><mi mathvariant=\"bold\">X</mi><mo separator=\"true\">,</mo><mi mathvariant=\"bold\">y</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mi>J</mi><mo stretchy=\"false\">(</mo><mi mathvariant=\"bold\">θ</mi><mo separator=\"true\">;</mo><mi mathvariant=\"bold\">X</mi><mo separator=\"true\">,</mo><mi mathvariant=\"bold\">y</mi><mo stretchy=\"false\">)</mo><mo>+</mo><mi>α</mi><mi mathvariant=\"normal\">Ω</mi><mo stretchy=\"false\">(</mo><mi mathvariant=\"bold\">θ</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">\\tilde{J}(\\mathbf{\\theta}; \\mathbf{X}, \\mathbf{y}) = J(\\mathbf{\\theta}; \\mathbf{X}, \\mathbf{y}) + \\alpha \\Omega(\\mathbf{\\theta})</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.1701899999999998em;vertical-align:-0.25em;\"></span><span class=\"mord accent\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.9201899999999998em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.09618em;\">J</span></span><span style=\"top:-3.6023300000000003em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"accent-body\" style=\"left:-0.08332999999999999em;\"><span class=\"mord\">~</span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">θ</span><span class=\"mpunct\">;</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord mathbf\">X</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord mathbf\" style=\"margin-right:0.01597em;\">y</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.09618em;\">J</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">θ</span><span class=\"mpunct\">;</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord mathbf\">X</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord mathbf\" style=\"margin-right:0.01597em;\">y</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.0037em;\">α</span><span class=\"mord\">Ω</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">θ</span><span class=\"mclose\">)</span></span></span></span></span></div>\n<div class=\"math math-display\"><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>α</mi><mo>∈</mo><mo stretchy=\"false\">[</mo><mn>0</mn><mo separator=\"true\">,</mo><mi mathvariant=\"normal\">∞</mi><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">\\alpha \\in [0, \\infty]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5782em;vertical-align:-0.0391em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.0037em;\">α</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">∈</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">[</span><span class=\"mord\">0</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\">∞</span><span class=\"mclose\">]</span></span></span></span></span></div>\n<p>バイアスパラメータには関与せず重みのみにペナルティを課す．</p>\n<h3 id=\"l2パラメータ正則化\"><span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>L</mi><mn>2</mn></msup></mrow><annotation encoding=\"application/x-tex\">L^2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8141079999999999em;vertical-align:0em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">L</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141079999999999em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span></span></span></span></span>パラメータ正則化</h3>\n<p>重み減衰，リッジ回帰，ティホノフ正則化として知られる．\nステップごとの観点で言うと，重みの更新に際して一定の割合\n(<span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>ε</mi><mi>α</mi><mo separator=\"true\">,</mo><mi>ε</mi></mrow><annotation encoding=\"application/x-tex\">\\varepsilon\\alpha, \\varepsilon</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.19444em;\"></span><span class=\"mord mathnormal\">ε</span><span class=\"mord mathnormal\" style=\"margin-right:0.0037em;\">α</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord mathnormal\">ε</span></span></span></span></span>: learning rate)\nが間引かれながら学習を進めていく頃になる．\n学習全体の観点で言うと，パラメータが目的関数を減少させることに大きく寄与する方向には，\n相対的に重み減衰の影響が少ない．\n逆に学習において重要でない方向に対応する重みベクトルの要素は\n訓練全体で正則化を使うことで減衰する．</p>\n<h3 id=\"l1パラメータ正則化\"><span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>L</mi><mn>1</mn></msup></mrow><annotation encoding=\"application/x-tex\">L^1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8141079999999999em;vertical-align:0em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">L</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141079999999999em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span></span></span></span></span></span></span></span></span>パラメータ正則化</h3>\n<p>個々のパラメータの絶対値の総和を減衰項とする．\n<span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>L</mi><mn>2</mn></msup></mrow><annotation encoding=\"application/x-tex\">L^2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8141079999999999em;vertical-align:0em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">L</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141079999999999em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span></span></span></span></span>正則化と比して<span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>L</mi><mn>1</mn></msup></mrow><annotation encoding=\"application/x-tex\">L^1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8141079999999999em;vertical-align:0em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">L</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141079999999999em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span></span></span></span></span></span></span></span></span>正則化ではいくつかのパラメータの最適値が0になる\nスパースな解が得られる．\nこのスパース性を利用して特徴量選択を行うことができる．</p>\n<h1 id=\"条件付き最適化としてのノルムペナルティ\">条件付き最適化としてのノルムペナルティ</h1>\n<p>一般化ラグランジュ関数を構築することで制約問題にパラメータペナルティの問題を帰着させると，\nパラメータ正則化は重みの解の範囲を限定する作用があることがわかる．\n減衰項の係数である <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>α</mi></mrow><annotation encoding=\"application/x-tex\">\\alpha</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.43056em;vertical-align:0em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.0037em;\">α</span></span></span></span></span> を増減させることで，解の範囲を大まかに制御することができる．\n適切な範囲の係数である<span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>k</mi></mrow><annotation encoding=\"application/x-tex\">k</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.69444em;vertical-align:0em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span></span></span></span></span>がわかっている場合， <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>α</mi><mo>=</mo><mi>k</mi></mrow><annotation encoding=\"application/x-tex\">\\alpha = k</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.43056em;vertical-align:0em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.0037em;\">α</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.69444em;vertical-align:0em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span></span></span></span></span> として\nペナルティを課すよりも，解が範囲を超えたタイミングで <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"normal\">Ω</mi><mo stretchy=\"false\">(</mo><mi mathvariant=\"bold\">θ</mi><mo stretchy=\"false\">)</mo><mo>&#x3C;</mo><mi>k</mi></mrow><annotation encoding=\"application/x-tex\">\\Omega(\\mathbf{\\theta}) \\lt k</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">Ω</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">θ</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">&#x3C;</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.69444em;vertical-align:0em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03148em;\">k</span></span></span></span></span>\nの範囲に再射影する方が最適解ではない極小値に <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>θ</mi></mrow><annotation encoding=\"application/x-tex\">\\theta</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.69444em;vertical-align:0em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">θ</span></span></span></span></span> が陥らず効率的に値を探索できる．</p>\n<h1 id=\"正則化と制約不足問題\">正則化と制約不足問題</h1>\n<p>正則化を行うことで，サンプルに分散が観察されない時や劣決定系問題を含む場合に\n解を定めることができる．</p>\n<h1 id=\"データ集合の拡張\">データ集合の拡張</h1>\n<p>機械学習モデルの汎化性能を高める最善の方法はより多くのデータで訓練することであり，\nそのために偽データを訓練データの一部として用いることで，訓練データを水増しするアプローチがある．\nこのアプローチは分類において最も簡単な方法となる．\nただし，密度推定タスクなど，他の多くのタスクについても簡単に適用できるものではないことに\n留意されたい．</p>\n<p>特にデータ集合の拡張が効果を発揮している分野として物体認識がある．\nこの分野では画像の回転やスケーリングを行うことでデータの拡張を行う．</p>\n<p>ノイズを元データに加えると言う手法もデータ拡張の一つとみなせる．\nニューラルネットワークはノイズに対してあまり頑健でないことが証明されている．\nノイズへの頑健性を高めるためには単純にノイズを加えたデータで学習をする手法がある．\n入力へのノイズの注入は雑音除去自己符号器のような教師なし学習アルゴリズムの一部である．\n2014年にPoole et al.によりノイズの大きさを非常に注意深く調整すれば\nこの手法が極めて有効であることが証明された．\nドロップアウトもノイズの乗算を用いて新しい入力を構成する皇帝とみなせる．</p>\n<p>機械学習アルゴリズムのベンチマークを比較する際は，\nスコアを算出した際にデータ拡張が行われていたか確かめることが重要である．\nデータ集合の拡張の有無によって差が出ている場合，\n単純にモデルやアルゴリズムの比較ができないためである．</p>\n<h1 id=\"ノイズに対する頑健性\">ノイズに対する頑健性</h1>\n<p>一般的に，ノイズの追加は，特にノイズが隠れユニットに加えられた場合に，\n単純にパラメータを縮小するよりずっと強力になりうる．</p>\n<h3 id=\"出力目標へのノイズの注入\">出力目標へのノイズの注入</h3>\n<p>データ集合の拡張で記述したノイズ手法以外に，出力ラベルに対してノイズを含ませる手法も存在する．\nこのような手法の代表的なものがラベル平滑化と呼ばれる手法である．</p>\n<h1 id=\"半教師あり学習\">半教師あり学習</h1>\n<p>表現を学習する手法であるらしいがあまり理解できなかった．\nChapelle et al, (2006)に詳細が書いてあるらしい．</p>\n<h1 id=\"マルチタスク学習\">マルチタスク学習</h1>\n<p><em>異なるタスクに関連づけられているデータで観測される変動を説明する因子の中には，\n二つ以上のタスクの間で共有されるものがいくつか存在する</em>\nと言う事前信念のもとに適用される．\nモデルの一部を異なるタスク間で共有し，重みも共有することで汎化性能を改善する．\nこのようなモデルのパラメータは</p>\n<ol>\n<li>タスク固有のパラメータ</li>\n<li>異なるタスク間で共有されるパラメータ</li>\n</ol>\n<p>汎化と汎化誤差の浄化をこれらのモデルによって改善することが可能である．</p>\n<h1 id=\"早期終了\">早期終了</h1>\n<p>エポック数を回し切った最後のパラメタではなく，\n検証誤差が最少となったエポックでのパラメタを返す手法を早期終了という．\n早期終了はその単純さと有効性から，深層学習において一般的に最も使われている正則化である．</p>\n<p>最大のメリットとして，ハイパーパラメタの一つであるエポック数を排除できることが挙げられる．\n逆に，デメリットは訓練中に定期的に検証誤差を測定する必要があるということと，\n最良のパラメタのコピーを保持する必要があるという点である．\nしかしパラメタの保持についてはメモリに格納する必要はないため，通常無視することができる．</p>\n<p>早期終了では検証集合が必要となるため，一部のデータが訓練で使えないこととなる．\nこれらのデータを使いたい場合，早期終了を行い，最適なエポック数やモデル訓練回数を調べた後に，\n同様の回数でもう一度始めから訓練するという手法がある．\nこの場合，パラメタの更新回数を等しくするのかエポック数を等しくするかの2通りの手法がある．\nまた，早期終了で得たパラメタを保持したまま追加分のデータを含めたデータ集合で訓練するという\n手法もある．\nしかし，この手法は一般的に良好な結果を示さない．</p>\n<h1 id=\"パラメタ拘束とパラメタ共有\">パラメタ拘束とパラメタ共有</h1>\n<p>類似したタスクを，類似した入出力をもつ二つのモデルの重み <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msubsup><mi>w</mi><mi>i</mi><mrow><mo stretchy=\"false\">(</mo><mi>A</mi><mo stretchy=\"false\">)</mo></mrow></msubsup><mo separator=\"true\">,</mo><msubsup><mi>w</mi><mi>i</mi><mrow><mo stretchy=\"false\">(</mo><mi>B</mi><mo stretchy=\"false\">)</mo></mrow></msubsup></mrow><annotation encoding=\"application/x-tex\">w_i^{(A)}, w_i^{(B)}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.321664em;vertical-align:-0.27686399999999994em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.0448em;\"><span style=\"top:-2.4231360000000004em;margin-left:-0.02691em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span><span style=\"top:-3.2198em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mopen mtight\">(</span><span class=\"mord mathnormal mtight\">A</span><span class=\"mclose mtight\">)</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.27686399999999994em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.0448em;\"><span style=\"top:-2.4231360000000004em;margin-left:-0.02691em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span><span style=\"top:-3.2198em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mopen mtight\">(</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05017em;\">B</span><span class=\"mclose mtight\">)</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.27686399999999994em;\"><span></span></span></span></span></span></span></span></span></span></span>\nがあるとき，片方の学習時にもう片方の学習済みパラメタに近づけるように\nノルムペナルティを課すことをパラメタ拘束といい，\n完全に学習済みのパラメタと同じになるように学習することをパラメタ共有という．</p>\n<h3 id=\"畳み込みニューラルネットワーク\">畳み込みニューラルネットワーク</h3>\n<p>パラメタ共有最大の活躍の場は間違いなく畳み込みニューラルネットワークである．\n特に画像認識において1ピクセルのずれても猫は猫である．\nそのため，入力全体に対して同様の重みを持つ隠れユニットを用いて計算することが有効となる．</p>\n<h1 id=\"スパース表現\">スパース表現</h1>\n<p>下記のような正則化を用いることでパラメタのスパース表現が可能になる．</p>\n<ul>\n<li><span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>L</mi><mn>1</mn></msup></mrow><annotation encoding=\"application/x-tex\">L^1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8141079999999999em;vertical-align:0em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">L</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141079999999999em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span></span></span></span></span></span></span></span></span> ノルムペナルティ</li>\n<li>スチューデントのt事前分布から導かれたペナルティ</li>\n<li>KLダイバージェンスペナルティ</li>\n<li>直行マッチング追跡</li>\n</ul>\n<h1 id=\"バギングやその他のアンサンブル手法\">バギングやその他のアンサンブル手法</h1>\n<p>バギング(Bootstrap AGGregatING)はいくつかのモデルを組み合わせることで汎化誤差を\n減少させる手法である．\nモデル平均化と呼ばれる機械学習の一般的な手法や．\nアンサンブル手法などが含まれる？</p>\n<p>(この辺りの関係はイマイチわかっていないので後で調べるかもしれない)</p>\n<p>モデル平均化は汎化誤差を削減する手法としては極めて強力で信頼できるものである．</p>\n<h1 id=\"ドロップアウト\">ドロップアウト</h1>\n<p><strong>ドロップアウトは最強である</strong></p>\n<p>ドロップアウトは大規模なニューラルネットワークに対して\nバギングを実用的に行う手法であると考えられる．\n具体的な手法はランダムに隠れユニットからの出力が0になる場所を作成する．\nそして，出力のないユニットが覗かれたランダムなモデルを含んだアンサンブル学習を\n近似的に行っていると見做すことができる．</p>\n<p>ドロップアウトは重み減衰やスパース活動正則化といった標準的で\n計算コストの低い他の正則化手法より効果的であることが示されている．\nただし，訓練事例がニューラルネットワークに用いる標準的な量と比して，\n極端に小さい場合はその限りではないという結果も得られている．</p>\n<p>また，ドロップアウトを用いることで各隠れユニットは他の隠れユニットが\nどのようなものであろうとも性能を発揮できるように学習されるという利点もある．</p>\n<h1 id=\"敵対的学習\">敵対的学習</h1>\n<p>ニューラルネットワークは高い線型性を持っているため，入力値の小さな変化に対して\n大きく反応してしまうことがある．\n例えばパンダの画像にノイズを混ぜると，\n人間はその画像をただのパンダの画像としか認知できないが，\n元の画像ではパンダと認識できていた深層学習モデルはそれをテナガザルと推論することもある．\nこの事例を逆手に取り，例えばノイズを加えた画像を訓練事例に含めていくことで\n誤り率を減少させることが可能である．</p>\n<h1 id=\"接距離，接線伝播法，多様体接分類器\">接距離，接線伝播法，多様体接分類器</h1>\n<p>次元の呪いを克服するため，機械学習の分野では多様体仮説を元に学習を行うことが多い．\n接距離アルゴリズムと\u0010接線伝播アルゴリズムはその仮説をそのままアルゴリズムに持ち込む．\n特に接線伝播法はデータ集合拡張や二重逆伝播法，敵対的学習などと関係する．</p>\n<h1 id=\"まとめ\">まとめ</h1>\n<p><em>ドロップアウトと早期学習を組み合わせておけばなんかうまい感じによしなになりそうな説！</em></p>","ogImage":{"url":"/assets/blog/dynamic-routing/cover.jpg"},"coverImage":"/assets/blog/dynamic-routing/cover.jpg"}},"__N_SSG":true}